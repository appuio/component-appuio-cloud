parameters:
  appuio_cloud:
    =_metadata: {}
    namespace: appuio-cloud

    bypassNamespaceRestrictions:
      roles: {}
      clusterRoles:
        cluster-admin: cluster-admin
        cluster-image-registry-operator: cluster-image-registry-operator
        cluster-node-tuning-operator: cluster-node-tuning-operator
        kyverno:generatecontroller: kyverno:generatecontroller
        kyverno:policycontroller: kyverno:policycontroller
        multus-admission-controller-webhook: multus-admission-controller-webhook
        openshift-dns-operator: openshift-dns-operator
        openshift-ingress-operator: openshift-ingress-operator
        syn-admin: syn-admin
        syn-argocd-application-controller: syn-argocd-application-controller
        syn-argocd-server: syn-argocd-server
        syn-resource-locker-*: syn-resource-locker-*
        system:controller:generic-garbage-collector: system:controller:generic-garbage-collector
        system:controller:operator-lifecycle-manager: system:controller:operator-lifecycle-manager
        system:master: system:master
        system:openshift:controller:namespace-security-allocation-controller: system:openshift:controller:namespace-security-allocation-controller
      subjects: {}

    reservedNamespaces:
      kubernetes: ["default", "kube-*"]
      openshift: openshift-*
      projectsyn: syn-*
      appuio: appuio-*
      cilium: cilium*

    allowedNamespaceLabels:
      kubernetesGenerated:
        - kubernetes.io/metadata.name
      appuioUserDefined: custom.appuio.io/*
      appuioOrg: appuio.io/organization
      # As defined in component-networkpolicy: https://github.com/projectsyn/component-networkpolicy/blob/master/class/defaults.yml
      netPolNoDefaults: network-policies.syn.tools/no-defaults
      netPolPurgeDefaults: network-policies.syn.tools/purge-defaults

    allowedNamespaceAnnotations:
      kubernetesGenerated:
        - kubectl.kubernetes.io/last-applied-configuration
      appuioUserDefined: custom.appuio.io/*
      runOnceActiveDeadlineSecondsOverride: ${appuio_cloud:runOnceActiveDeadlineSeconds:overrideAnnotationKey}
      # If using mutate, Kyverno appends an annotation to debug the mutate patches.
      # The annotation is appended in the context of the original requestor.
      # Thus we have to whitelist the annotation or the later validation rejects the request.
      # This should be safe because:
      # - The annotation is only for debugging and not referenced elsewhere.
      # - The mutating policies are validated with a validation rule too.
      kyvernoMutateLabel: policies.kyverno.io/last-applied-patches

    generatedDefaultRoleBindingInNewNamespaces:
      bindingName: organization-admin
      clusterRoleName: admin

    generatedNamespaceOwnerRole:
      name: namespace-owner

    maxNamespaceQuota: 25
    namespaceQuotaOverrides: {}

    generatedResourceQuota:
      # See https://kb.vshn.ch/appuio-cloud/references/quality-requirements/performance/resource-quota.html
      organization-objects:
        synchronize: true
        spec:
          hard:
            count/configmaps: "150"
            count/secrets: "150"
            count/services: "20"
            count/services.loadbalancers: "0"
            count/services.nodeports: "0"
            count/replicationcontrollers: "100"
            openshift.io/imagestreams: "20"
            openshift.io/imagestreamtags: "50"

            requests.storage: 1000Gi
            persistentvolumeclaims: "10"
            localblock-storage.storageclass.storage.k8s.io/persistentvolumeclaims: "0"
            requests.ephemeral-storage: "250Mi"
            limits.ephemeral-storage: "500Mi"

      organization-compute:
        synchronize: true
        spec:
          hard:
            requests.cpu: 4
            requests.memory: 4Gi
            limits.cpu: 8
            limits.memory: 20Gi
            pods: "45"
          scopes:
            - NotTerminating

      organization-compute-terminating:
        synchronize: true
        spec:
          hard:
            limits.cpu: 4000m
            limits.memory: 4Gi
            pods: "5"
            requests.cpu: 500m
            requests.memory: 2Gi
          scopes:
            - Terminating

    generatedLimitRange:
      name: organization
      synchronize: true
      limits:
        "Container":
          max:
            cpu: "1"
            memory: "4Gi"
          min:
            cpu: "10m"
            memory: "4Mi"
            ephemeral-storage: "100Ki"
          default:
            cpu: "200m"
            memory: "200Mi"
          defaultRequest:
            cpu: "100m"
            memory: "100Mi"

    disallowDockerBuildStrategy: true

    projectTemplate:
      enabled: false
      objects:
        project:
          apiVersion: project.openshift.io/v1
          kind: Project
          metadata:
            annotations:
              openshift.io/description: '\${PROJECT_DESCRIPTION}'
              openshift.io/display-name: '\${PROJECT_DISPLAYNAME}'
              openshift.io/requester: '\${PROJECT_REQUESTING_USER}'
            name: '\${PROJECT_NAME}'
      parameters:
        PROJECT_NAME: {}
        PROJECT_DISPLAYNAME: {}
        PROJECT_DESCRIPTION: {}
        PROJECT_ADMIN_USER: {}
        PROJECT_REQUESTING_USER: {}

    runOnceActiveDeadlineSeconds:
      defaultActiveDeadlineSeconds: 1800
      overrideAnnotationKey: appuio.io/active-deadline-seconds-override
