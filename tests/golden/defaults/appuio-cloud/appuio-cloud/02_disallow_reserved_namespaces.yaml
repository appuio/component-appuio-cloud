apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata:
  annotations: {}
  labels:
    app.kubernetes.io/component: appuio-cloud
    app.kubernetes.io/managed-by: commodore
    app.kubernetes.io/name: appuio-cloud
    name: disallow-reserved-namespaces
  name: disallow-reserved-namespaces
spec:
  background: false
  rules:
    - exclude:
        clusterRoles:
          - cluster-admin
          - appuio:edit-reserved-namespaces
      match:
        resources:
          kinds:
            - Namespace
          names:
            - default
            - kube-*
            - openshift-*
            - syn-*
            - vshn-*
            - appuio-*
      name: disallow-reserved-namespaces
      validate:
        deny: {}
        message: Changing or creating reserved namespaces is not allowed.
  validationFailureAction: enforce
